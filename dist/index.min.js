!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("library",[],e):"object"==typeof exports?exports.library=e():t.library=e()}(global,(function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var o=e[n]={i:n,l:!1,exports:{}};return t[n].call(o.exports,o,o.exports,r),o.l=!0,o.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var o in t)r.d(n,o,function(e){return t[e]}.bind(null,o));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=1)}([function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.xlsx_date=function(t,e,r){var n,o=Math.floor(t),i=Math.round(86400*(t-o));return e&&(o+=1462),60===o?n=new Date(1900,1,29):(o>60&&--o,(n=new Date(1900,0,1,0,0,0)).setDate(n.getDate()+o-1)),n.setSeconds(i%60),i=Math.floor(i/60),n.setMinutes(i%60),i=Math.floor(i/60),r||(i-=n.getTimezoneOffset()/60),n.setHours(i),n},e.xlsx_fmts={0:null,1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm-dd-yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};var n="ABCDEFGHIJKLMNOPQRSTUVWXYZ";function o(t){for(var e=0,r=1,n=t.length-1;n>=0;n--){e+=(t[n].charCodeAt(0)-"A".charCodeAt(0)+1)*r,r*=26}return e-1}function i(t,e){for(var r=0;r<t.length;r++)if(e.indexOf(t[r])<0)return!1;return t.length>0}function s(t){for(var e=t,r="";e.length>0;){var n=e[0];e=e.slice(1),"_"===n||"\\"===n||"*"===n?e=e.slice(1):"["===n?e=e.slice(e.indexOf("]")+1):'"'===n?e=e.slice(e.indexOf('"')+1):"("===n||")"===n||(r+=n)}var o=(r=r.replace(/#/g,"0").replace(/%/g,"")).split(",");if(""===(r=o[o.length-1])||r.trim().indexOf(" ")<0&&!isNaN(parseInt(r,10))){if(r.indexOf(".")>=0){var s=o[o.length-1].split(".")[1].trim().length;return r.indexOf("E+")>=0&&(s+=14),{t:"f",f:s}}return{t:"i"}}return"@"===r?{t:"s"}:"??"===r?{t:"l"}:(o=r.split(" ")).length>1&&i(o[o.length-1],"?/")?{t:"f",f:o[o.length-1].split("/")[0].trim().length+1}:i(r,"tmdyhseAPTMH:/-.0 ")?{t:"d"}:{t:"x"}}e.numAlpha=function t(e){var r=Math.floor(e/26)-1;return(r>-1?t(r):"")+n.charAt(e%26)},e.alphaNum=o,e.containsOnlyChars=i,e.splitCellFormats=function(t){for(var e=t.split(/(?!\\);/),r={t:"x"},n=[],o=0;o<e.length;o++){var i=s(e[o]);r=i="l"===i.t?r:i,n.push({fmt:e[o],fmt_type:i.t,digits:i.f})}return n},e.getColumnFromDef=function(t){for(var e="",r=0;r<t.length&&isNaN(parseInt(t[r],10));r++)e+=t[r];return o(e)},e.isValidDate=function(t){return t instanceof Date&&!isNaN(t.getTime())},e.escapeTSV=function(t,e){var r=e.tsv_delimiter||"\t";return(t&&t.indexOf('"')>-1||t.indexOf("\n")>-1||t.indexOf("\r")>-1||t.indexOf(r)>-1)&&(t='"'+t.replace(/"/g,'""')+'"'),t},e.unescapexml=function t(e){var r={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},n=e+"",o=n.indexOf("<![CDATA[");if(-1===o)return n.replace(/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/g,(function(t,e){return r[t]||String.fromCharCode(parseInt(e,t.indexOf("x")>-1?16:10))||t})).replace(/_x([\da-fA-F]{4})_/g,(function(t,e){return String.fromCharCode(parseInt(e,16))}));var i=n.indexOf("]]>");return t(n.slice(0,o))+n.slice(o+9,i)+t(n.slice(i+3))}},function(t,e,r){"use strict";var n,o=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])})(t,e)},function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}),i=this&&this.__importStar||function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)Object.hasOwnProperty.call(t,r)&&(e[r]=t[r]);return e.default=t,e};Object.defineProperty(e,"__esModule",{value:!0});var s=i(r(2)),a=i(r(3)),u=i(r(4)),f=i(r(5)),l=r(6),c=function(t){function e(){var r=t.call(this)||this;return f.inherits(e,s.EventEmitter),s.EventEmitter.call(r),r}return o(e,t),e.prototype.extract=function(t,e){var r=this;return new l.XLSXReader(t,e).read((function(t,e){r.emit(t,e)})),this},e.prototype.convert=function(t,e,r){var n=this;(r=r||{}).format||".json"!==u.extname(e).toLowerCase()||(r.format="json"),"json"!==r.format&&(r.format="tsv");var o,i=!0,s="tsv"!==r.format;try{o=a.createWriteStream(e),s&&o.write("[")}catch(t){return this.emit("error",t),this.emit("end"),this}return o.on("close",(function(){n.emit("end")})),new l.XLSXReader(t,r).read((function(t,e){switch(t){case"error":n.emit("error",e);break;case"cell":n.emit("cell",e);break;case"row":s&&(i?(i=!1,o.write(r.tsv_endofline)):o.write(","+r.tsv_endofline)),n.emit("row",e),o.write(e);break;case"end":s&&o.write(r.tsv_endofline+"]"),o.end()}})),this},e}(s.EventEmitter);e.XLSX=c},function(t,e){t.exports=require("events")},function(t,e){t.exports=require("fs")},function(t,e){t.exports=require("path")},function(t,e){t.exports=require("util")},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=r(7),i=r(8),s=r(9),a=r(10),u=r(11),f=r(14),l=r(16),c=function(){function t(t,e){this.options={},this.filename=t,this.options=f.applyDefaults(e),this.workfolder=this.options.workfolder||"xl"}return t.prototype.createParser=function(){return"expat"===this.options.parser?new u.SaxExpat:new u.SaxSax},t.prototype.createUnzip=function(){return new l.YauzlUnzip},t.prototype.parseXMLSheet=function(t,e,r,o){var a,u,f=this,l=!1,c=!1,p=1,h=this.createParser().onStartElement((function(t,o){if("row"===t){if(f.options.include_empty_rows){for(var h=parseInt(o.r||"",10);p<h;)p++,r(new i.Row);p=h+1}a=new i.Row}else if("c"===t){for((u=new s.Cell).typ=o.t?o.t:"n",u.fmt=o.s?e.styles[o.s]:void 0,u.address=o.r,u.col=n.getColumnFromDef(o.r||"");a.count()<u.col;){var d=new s.Cell;d.col=a.count(),a.push(d),r(null,u)}a.push(u)}else"v"===t?l=!0:"t"===t?l=!0:"f"===t&&(c=!0)})).onEndElement((function(t){"row"===t?a&&(a.cells.length>0||f.options.include_empty_rows)&&r(a):"v"===t?l=!1:"t"===t?l=!1:"f"===t?c=!1:"c"===t&&(l=!1,void 0!==u.col&&u.col>=0&&("s"===u.typ&&(u.val=e.sharedStrings[parseInt(u.val,10)]),u.raw=u.val,f.options.raw_values||u.convertValue(f.options),r(null,u)))})).onText((function(t){l&&(u.val=(u.val?u.val:"")+t),c&&(u.formula=(u.formula?u.formula:"")+t)})).onClose(o);t.pipe(h.piper())},t.prototype.parseXMLWorkbookSheets=function(t,e){var r=[],n=this.createParser().onStartElement((function(t,e){if("sheet"===t){var n=new a.Sheet;n.rid=e["r:id"]||"",n.id=e.sheetid,n.nr=(r.length+1).toString(),n.name=e.name,r.push(n)}})).onClose((function(t){e(t,r)}));t.pipe(n.piper())},t.prototype.parseXMLWorkbookRelations=function(t,e){var r=[],n=this.createParser().onStartElement((function(t,e){"relationship"===t&&"string"==typeof e.target&&e.target.toLowerCase().indexOf("worksheets/sheet")>=0&&e.id&&r.push({sheetid:e.id,filename:e.target})})).onClose((function(t){e(t,r)}));t.pipe(n.piper())},t.prototype.parseXMLStyles=function(t,e){var r={},o={},i=[],s=!1,a=this.createParser().onStartElement((function(t,e){if("numfmt"===t)e.numfmtid&&e.formatcode&&(o[e.numfmtid]=e.formatcode);else if("cellxfs"===t)s=!0;else if(s&&"xf"===t){var a=parseInt(e.numfmtid||"",10);i.push(a);var u=(i.length-1).toString(),f=o[a]||n.xlsx_fmts[a];r[u]={fmt:null===f?void 0:f,fmtnr:a,fmts:f?n.splitCellFormats(f):[],def:e}}})).onEndElement((function(t){"cellxfs"===t&&(s=!1)})).onClose((function(t){e(t,r)}));t.pipe(a.piper())},t.prototype.parseXMLStrings=function(t,e){var r=[],n=!1,o=[],i="",s=!1,a=this.createParser().onStartElement((function(t,e){"si"===t?o=[]:"t"===t?(n=!0,i=""):"rph"===t&&(s=!0)})).onEndElement((function(t){"t"===t?(o.push(i),n=!1):"rph"===t?s=!1:"si"===t&&r.push(o.join(""))})).onText((function(t){n&&!s&&(i+=t.replace(/\r\n/g,"\n"))})).onClose((function(t){e(t,r)}));t.pipe(a.piper())},t.prototype.getLookups=function(t){var e,r=this,n=[];if(this.options.sheet_all)return t.sheets.forEach((function(e){var o=t.relations.find((function(t){return t.sheetid===e.rid}));o&&n.push({sheet:e,filename:r.workfolder+"/"+o.filename})})),n;if(this.options.sheet_name)e=t.getByName(this.options.sheet_name);else if(this.options.sheet_rid)e=t.getByRId(this.options.sheet_rid.toString());else if(this.options.sheet_id){var o=this.options.sheet_id.toString();e=t.getById(o)}else{var i=this.options.sheet_nr||"1";(e=t.getByNr(i))||n.push({filename:this.workfolder+"/worksheets/sheet"+i+".xml"})}if(e){var s=e.rid,a=t.relations.find((function(t){return t.sheetid===s}));a&&n.push({sheet:e,filename:this.workfolder+"/"+a.filename})}return n},t.prototype.parseSheets=function(t,e){var r=this,n=1,o=function(){0===n&&e({})},i=this.getLookups(t);this.createUnzip().read(this.filename,(function(s){var a=i.find((function(t){return t.filename===s.path}));if(a){n++;var u=1,f=r.options.ignore_header||0;a.sheet&&e({sheet:a.sheet}),r.parseXMLSheet(s,t,(function(t,r){r?u>f&&e({cell:r}):t&&(u>f&&e({row:t}),u++)}),(function(t){t?e({err:t}):(n--,o())}))}else s.ignore()}),(function(t){e({err:t}),e({})}),(function(){n--,o()}))},t.prototype.parseWorkbook=function(t){var e=this,r=new o.Workbook,n=1,i=function(){0===--n&&e.parseSheets(r,t)};this.createUnzip().read(this.filename,(function(t){t.path===e.workfolder+"/sharedStrings.xml"?(n++,e.parseXMLStrings(t,(function(t,e){r.sharedStrings=e,i()}))):t.path===e.workfolder+"/styles.xml"?(n++,e.parseXMLStyles(t,(function(t,e){r.styles=e,i()}))):t.path===e.workfolder+"/workbook.xml"?(n++,e.parseXMLWorkbookSheets(t,(function(t,e){r.sheets=e,i()}))):t.path===e.workfolder+"/_rels/workbook.xml.rels"?(n++,e.parseXMLWorkbookRelations(t,(function(t,e){r.relations=e,i()}))):t.ignore()}),(function(e){t({err:e}),t({})}),(function(){i()}))},t.prototype.read=function(t){var e=this;this.parseWorkbook((function(r){r.err?t("error",r.err):r.cell?t("cell",r.cell.getFormat(e.options)):r.row?t("row",r.row.getFormat(e.options)):r.sheet?t("sheet",r.sheet.getFormat(e.options)):t("end")}))},t}();e.XLSXReader=c},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.sheets=[],this.sharedStrings=[],this.styles={},this.relations=[]}return t.prototype.getByRId=function(t){return this.sheets.find((function(e){return e.rid===t}))},t.prototype.getById=function(t){return this.sheets.find((function(e){return e.id===t}))},t.prototype.getByNr=function(t){return this.sheets.find((function(e){return!!e.nr&&e.nr.toString()===t.toString()}))},t.prototype.getByName=function(t){return this.sheets.find((function(e){return e.name===t}))},t}();e.Workbook=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){this.cells=[]}return t.prototype.getFormat=function(t){switch(t.format){case"json":return this.toJson();case"array":return this.toArray();case"obj":return this;default:return this.toTSV(t)}},t.prototype.toTSV=function(t){return this.cells.map((function(e){return e.toTSV(t)})).join(t.tsv_delimiter||"\t")+t.tsv_endofline},t.prototype.toJson=function(){return JSON.stringify(this.toArray())},t.prototype.toArray=function(){return this.cells.map((function(t){return t.val}))},t.prototype.push=function(t){this.cells.push(t)},t.prototype.count=function(){return this.cells.length},t.prototype.isEmpty=function(){return 0===this.cells.length||0===this.cells.filter((function(t){return null!==t.val})).length},t}();e.Row=n},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(0),o=function(){function t(){}return t.prototype.getFormat=function(t){switch(t.format){case"json":return this.toJson();case"array":return this.val;case"obj":return this;default:return this.toTSV(t)}},t.prototype.toTSV=function(t){var e;return e=null===this.val||void 0===this.val||void 0===this.raw?"":n.isValidDate(this.val)?this.val.toISOString():this.val.toString(),t.tsv_float_comma&&"number"==typeof this.val&&(e=e.replace(".",",")),n.escapeTSV(e,t)},t.prototype.toJson=function(){return JSON.stringify(this.val)},t.prototype.getEffectiveNumFormat=function(){return this.fmt&&0!==this.fmt.fmts.length?1===this.fmt.fmts.length?this.fmt.fmts[0]:isNaN(this.val)?this.fmt.fmts[3]:this.val<0?this.fmt.fmts[1]:this.val>0?this.fmt.fmts[0]:this.fmt.fmts[this.fmt.fmts.length>2?2:0]:null},t.prototype.applyNumFormat=function(t){var e=this.getEffectiveNumFormat();if(e&&t.convert_values)switch(e.fmt_type){case"d":t.convert_values.dates&&(this.val=n.xlsx_date(this.val,!!t.date1904,!!t.ignore_timezone));break;case"i":if(t.convert_values.ints){var r=null;r=!this.fmt||"0\\ %"!==this.fmt.fmt&&"0%"!==this.fmt.fmt?parseInt(this.val,10):Math.round(100*parseFloat(this.val)),isNaN(r)||(this.val=r)}break;case"f":if(void 0!==e.digits&&e.digits>0&&t.convert_values.floats){t.round_floats&&!isNaN(this.val)&&(this.val=this.val.toFixed(e.digits));var o=parseFloat(this.val);isNaN(o)||(this.val=o)}}},t.prototype.convertValue=function(t){if(null!==this.val)switch(this.typ){case"n":var e=parseFloat(this.val);isNaN(e)||(this.val=e),this.fmt&&t.convert_values&&this.applyNumFormat(t);break;case"str":this.raw&&(this.val=n.unescapexml(this.raw));break;case"s":case"inlineStr":break;case"b":t.convert_values&&t.convert_values.bools&&(["0","FALSE","false"].indexOf(this.val)>=0?this.val=!1:["1","TRUE","true"].indexOf(this.val)>=0&&(this.val=!0))}},t}();e.Cell=o},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=function(){function t(){}return t.prototype.getFormat=function(t){switch(t.format){case"json":return this.toJson();case"array":return this.toArray();case"obj":return this;default:return this.toTSV(t)}},t.prototype.toTSV=function(t){return this.toArray().join(t.tsv_delimiter||"\t")+t.tsv_endofline},t.prototype.toJson=function(){return JSON.stringify({name:this.name,nr:this.nr,rid:this.rid,id:this.id})},t.prototype.toArray=function(){return[this.name,this.rid,this.nr,this.id]},t}();e.Sheet=n},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o,i=n(r(12));function s(t){var e={};return Object.keys(t).forEach((function(r){e[r.toLowerCase()]=t[r]})),e}var a=function(){function t(){this.parser=i.default.createStream(!1,{lowercase:!0})}return t.prototype.onStartElement=function(t){return this.parser.on("opentag",(function(e){t(e.name.toLowerCase(),s(e.attributes))})),this},t.prototype.onEndElement=function(t){return this.parser.on("closetag",(function(e){t(e.toLowerCase())})),this},t.prototype.onText=function(t){return this.parser.on("text",t),this},t.prototype.onClose=function(t){var e=this,r=!1;return this.parser.on("error",(function(n){r||(r=!0,t(n)),e.parser.error=null,e.parser.resume()})),this.parser.on("end",(function(){r||t()})),this},t.prototype.piper=function(){return this.parser},t}();e.SaxSax=a;var u=function(){function t(){if(!o)try{o=r(13)}catch(t){throw new Error('To use {parser:"expat"} you need to install it manually with "npm install node-expat"')}this.parser=o.createParser()}return t.prototype.onStartElement=function(t){return this.parser.on("startElement",(function(e,r){t(e.toLowerCase(),s(r))})),this},t.prototype.onEndElement=function(t){return this.parser.on("endElement",(function(e){t(e.toLowerCase())})),this},t.prototype.onText=function(t){return this.parser.on("text",t),this},t.prototype.onClose=function(t){var e=!1;return this.parser.on("error",(function(r){e=!0,t(r)})),this.parser.on("close",(function(){e||t()})),this},t.prototype.piper=function(){return this.parser},t}();e.SaxExpat=u},function(t,e){t.exports=require("sax")},function(t,e){t.exports=require("node-expat")},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(15));e.applyDefaults=function(t){var e={sheet_nr:"1",ignore_header:0,date1904:!1,include_empty_rows:!1,tsv_float_comma:!1,tsv_delimiter:"\t",tsv_endofline:o.default.EOL,parser:"sax",format:"array",workfolder:"xl",raw_values:!1,round_floats:!0,convert_values:{ints:!0,floats:!0,dates:!0,bools:!0}};return Object.assign(e,t)}},function(t,e){t.exports=require("os")},function(t,e,r){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});var o=n(r(17)),i=function(){function t(t,e){this.entry=t,this.zipfile=e,this.path=t.fileName}return t.prototype.pipe=function(t){var e=this;this.zipfile.openReadStream(this.entry,(function(r,n){if(r)throw r;if(!n)throw new Error("No data for zip file entry");n.on("end",(function(){e.zipfile.readEntry()})),n.pipe(t)}))},t.prototype.ignore=function(){this.zipfile.readEntry()},t}();e.YauzlUnzipEntry=i;var s=function(){function t(){}return t.prototype.read=function(t,e,r,n){o.default.open(t,{lazyEntries:!0,autoClose:!0},(function(t,o){return t?r(t):o?(o.on("error",(function(t){r(t)})),o.on("entry",(function(t){if(/\/$/.test(t.fileName))o.readEntry();else{var r=new i(t,o);e(r)}})),o.once("end",(function(){n()})),void o.readEntry()):r(new Error("No zip data found in file"))}))},t}();e.YauzlUnzip=s},function(t,e){t.exports=require("yauzl")}])}));
//# sourceMappingURL=index.min.js.map